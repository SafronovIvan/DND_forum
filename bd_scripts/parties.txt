CREATE TYPE party_status AS ENUM (
    'Набор открыт',
    'Набор закрыт',
    'В процессе',
    'Завершена'
);

CREATE TABLE parties (
	"id" SERIAL PRIMARY KEY,
    "dm_id" INTEGER REFERENCES users(id) ON DELETE SET NULL,
    "title" VARCHAR(50) NOT NULL,
    "description" TEXT NOT NULL,
    "min_players" INTEGER DEFAULT 3 CHECK (min_players BETWEEN 1 AND 99),
    "max_players" INTEGER DEFAULT 5 CHECK (max_players BETWEEN 1 AND 99),
    CHECK (max_players >= min_players),
    "status" party_status DEFAULT 'Набор открыт',
    "schedule_date" DATE NOT NULL,
    "schedule_time" TIME NOT NULL,
    "location" VARCHAR(500) NOT NULL,
    "image_address" VARCHAR(500),
    "priority_system_enabled" BOOLEAN DEFAULT TRUE,
    "min_players_level" INTEGER DEFAULT 1 CHECK (min_players_level BETWEEN 1 AND 20),
    "max_players_level" INTEGER DEFAULT 1 CHECK (max_players_level BETWEEN 1 AND 20),
    CHECK (max_players_level >= min_players_level),
    "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP
)