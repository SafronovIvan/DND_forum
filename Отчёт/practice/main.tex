\documentclass[14pt]{extreport}
\input{prop/preamble.inc} % настройки по ГОСТ 7.32

\begin{document}

\SETwork{Учебная, ознакомительная практика}
% Проектирование архитектуры и бизнес-процессов 
\SETtheme{Разработка базы данных для веб-приложение для управления игровыми сессиями D\&D с системой приоритетов и балансировки групп.}
\SETauthor{Сафронов Иван Сергеевич K3221, \\ Сакулин Иван Михайлович K3221, Мануковская Дарья Михайловна K3221, Пухарев Сергей Валерьевич K3220, Мартенс Дмитрий Павлович K3220.}
\SETteacher{Казанова Полина Петровна}
\SETyear{2025}
\include{prop/title}
\tableofcontents

\intro % Введение
% Актуальность, цели, задачи, планируемые результаты в соответствии с Индивидуальным заданием. Имеющийся задел к началу практики.

В условиях активного развития веб-технологий и роста популярности настольных ролевых игр актуальной становится задача автоматизации процессов организации и управления игровыми сессиями. Одной из наиболее распространённых систем является Dungeons \& Dragons (далее D\&D), требующая координации игроков, мастеров, расписаний, а также соблюдения баланса игровых групп. Отсутствие специализированных инструментов управления приводит к перегрузке ведущих, снижению качества игрового процесса и неэффективному распределению участников по сессиям.

Необходимо спроектировать веб-приложение, обеспечивающее централизованное управление игровыми сессиями D\&D с использованием системы приоритетов и механизмов балансировки групп.

% (при загрузке на my.itmo) добавляем до индивидуальной темы
Цель: проектирование веб-приложения для управления игровыми сессиями D\&D с поддержкой приоритетного распределения участников и балансировки игровых групп.

% (при загрузке на my.itmo) убираем чужие темы
Задачи:
\begin{enumerate}[label=\arabic*)]
    \item анализ предметной области и существующих решений для управления игровыми сессиями;
    \item формализация функциональных и не функциональных требований;
    \item моделирование ключевых бизнес-процессов системы;
    \item разработка базы данных;
    \item создание прототипа интерфейса веб-приложения.
\end{enumerate}

% (при загрузке на my.itmo) переписываем под себя
В качестве планируемых результатов практики предусматривается получение формализованного описания системы для управления игровыми сессиями
D\&D с системой приоритетов и балансировки групп, которое может быть использовано в дальнейшем при реализации программного продукта. Итоговые материалы могут служить основой для разработки прототипа или полноценной информационной системы.

\chapter{Выполнение работы} % ГЛАВА 1
% Что было сделано за период практики? Какие методы/подходы/алгоритмы/информационные источники были использованы? Какие результаты получены? 
% Что способствовало / помешало выполнению Индивидуального задания (трудности, которые возникли в результате выполнения задания, какими способами они преодолевались)? Результаты работы могут быть/находятся на этапе/успешно внедрены в рамках \dots

В процессе прохождения практики были пройдены этапы организации команды, анализа предметной области

\section{Анализ и разработка требований}

Первым шагом практики стал анализ предметной области, компании и её требований, затем было проведено исследование аналогов платформы.

\subsection{Анализ компании}
% Размер, бюджет, кто будет поддерживать, типы пользователей.

В качестве компании было выбрано подразделение ролевых игр <<D\&D>> клуба настольных игр <<GEEKMO>>, которое несколько лет успешно проводит игры. Запись на игры в изучаемой компании проводится с помощью различных сторонних инструментов (публикации в социальной сети <<VK>>, записи через <<google>>-таблицы). Отбор и бизнес-логика выполняются вручную, отсутствует защита некоторых данных в таблицах.

Примерное число сотрудников компании (организаторы игр) в разное время составляет от 15 до 20 человек, только от 2 до 5 из них используют персональный компьютер для организации процесса и модерации заявок. На администраторской роли был четко обозначен лишь 1 сотрудник. Отсюда следует, что размер компании можно определить как <<очень малая>>.

Определены основные типы пользователей: помимо разработчиков и администраторов были также выделены обычные пользователи (игроки и игровые мастера) и модераторы (обычные пользователи с правом блокировки нежелательного контента).

На разработку веб-приложения было решено выделить однократные вложения в бюджет. После анализа была выбрана итерационная модель жизненного цикла (поэтапная разработка до достижения готового результата). Поддержку после создания платформы будет осуществлять обученный администратор компании. Найденные в течении определённого времени после окончания разработки во время эксплуатации ошибки остаются на исправления разработчикам.

\subsection{Аналоги}

Настоящее исследование позволяет идентифицировать системный дефицит на рынке платформ для организации игровых сессий в настольных ролевых играх, который выражается в отсутствии механизмов, гарантирующих уравнительный доступ к игровым ресурсам. Анализ существующих решений (таблица \ref{analogs}) демонстрирует, что их функциональность ограничивается либо предоставлением коммуникационной инфраструктуры (<<Discord>>), либо интеграцией с инструментарием виртуального стола (<<Fantasy Grounds>>), либо выполнением роли пассивного агрегатора объявлений (<<RPGTableFinder>>). Очень важным фактором также является ограниченность платформ в стране. При этом критически важный аспект -- алгоритмическое обеспечение справедливого распределения игровых мест -- остаётся нереализованным.

\begin{longtable}{|>{\hspace{0pt}}p{40mm}|>{\hspace{0pt}}p{60mm}|>{\hspace{0pt}}p{60mm}|}
\caption{Сравнение с аналогами\label{analogs}} \\ \hline
\centering\textbf{Название} & \centering\textbf{Преимущества}  & \centering\textbf{Недостатки} \tabularnewline \hline \endfirsthead
\multicolumn{2}{l}{\hspace{-8pt}Продолжение таблицы \ref{analogs}} \\ \hline{}
\centering\textbf{Название} & \centering\textbf{Преимущества}  & \centering\textbf{Недостатки} \tabularnewline\hline \endhead

Fantasy Grounds LFG &
1) Прямая интеграция с виртуальным столом Fantasy Grounds; 

2) Целевая аудитория опытных игроков и мастеров; 

3) Поддержка множества игровых систем (D\&D, Pathfinder, Savage Worlds). &
1) Требуется покупка лицензии (финансовый барьер); 

2) Устаревший форумный интерфейс, нет удобных фильтров; 

3) Отсутствие инструментов для справедливого отбора игроков. \\
\hline
Discord &
1) Гибкость и бесплатность настройки серверов под сообщества;

 2) Мгновенная коммуникация через голос и чаты; 

3) Огромная и активная аудитория игроков. &
1) Полный хаос в организации записи («гонка за места»); 

2) Отсутствие единого каталога и профилей игроков; 

3) Ручная работа модераторов по управлению списками. \\
\hline
RPGTableFinder &
1) Специализированный сервис для поиска онлайн и оффлайн игр;

 2) Возможность организовать свой стол и управлять расписанием; 

3) Удобный интерфейс с поиском и фильтрами. &
1) Небольшая база пользователей, особенно русскоязычных; 

2) Нет интеграции с популярными виртуальными столами; 

3) Нет алгоритмов для справедливого распределения мест. \\
\hline
\end{longtable}

\subsection{Проблемы, решаемые продуктом}

Разрабатываемая платформа отличается от большинства других сервисов для поиска игр <<D\&D>>. Её основная идея заключается в справедливом распределении игроков, так, чтобы возможность попасть в игру была у каждого. Приоритет получает тот пользователь, который дольше всего не участвовал в играх. Данный подход решает несколько проблем, которые имеются у уже существующих аналогов:

\begin{enumerate}[label=\arabic*)]
    \item Исключение случайности -- у каждого пользователя одинаковые возможности для попадания на игру, причём каждый пользователь понимает принцип отбора. Такая система гораздо справедливее распространённого «кто быстрее».

    \item Меньше ручной работы -- разрабатываемая платформа сама формирует состав игроков, рассылает уведомления и ведёт очередь. Мастеру не нужно договариваться с каждым участником лично.

    \item Более устойчивое сообщество -- благодаря системе приоритетов, у каждого нового пользователя равные шансы с давним попасть в игру, что повышает шансы новых пользователей остаться в сообществе.

    \item Прозрачные правила -- все решения принимаются по заранее известным для всех пользователей правилам. Пользователи понимают, почему именно они получили или не получили место, и видят своё положение в очереди. Это снижает количество конфликтов и повышает доверие к платформе.
\end{enumerate}

Таким образом, главное отличие разрабатываемой платформы в том, что она не просто соединяет людей, а активно и справедливо управляет распределением игровых сессий. Это помогает решить проблему ограниченного числа мест в играх при большом количестве желающих и предлагает понятные и честные правила взаимодействия внутри игрового сообщества.

\section{Разработка проекта программной системы}

\subsection{Выбор инструментов: PostgreSQL}

Для реализации базы данных проекта был выбран PostgreSQL — реляционная СУБД с открытым исходным кодом, соответствующая требованиям проекта:

\begin{itemize}[leftmargin=*, itemsep=0.5em]
    \itemПоддержка сложных типов данных: Наличие встроенного типа ENUM (party\_status, queue\_status) обеспечивает строгость и читаемость данных, ограничивая возможные значения статусов.
    
    \item Целостность данных: Механизмы внешних ключей (FOREIGN KEY), проверочные ограничения (CHECK) и каскадные операции (ON DELETE CASCADE/SET NULL) гарантируют согласованность и непротиворечивость данных при любых манипуляциях.
    
    \item Производительность и масштабируемость: Индексирование по первичным ключам и потенциальным полям для поиска (например, username, email) обеспечит высокую скорость выполнения запросов даже при росте числа пользователей.
    
    \item Безопасность: Встроенные средства управления доступом и шифрования позволяют безопасно хранить конфиденциальные данные, такие как хэши паролей.
\end{itemize}

Данный выбор обеспечивает надежную, масштабируемую и легко сопровождаемую основу для backend-части итогового продукта.

\subsection{Обоснование структуры и архитектуры базы данных}

База данных спроектирована в нормализованной форме для минимизации избыточности и аномалий при вставке, обновлении и удалении данных. Структура состоит из четырех основных таблиц, связанных четкими отношениями.

Существующие таблицы изображены на рисунке \ref{schema}:

\begin{figure}[H]
    \centering
    \includegraphics[width=0.9\textwidth]{database.png}
    \caption{ER-диаграмма базы данных}
    \label{schema}
\end{figure}

\begin{enumerate}[leftmargin=*, itemsep=0.5em]
    \item users: Центральная таблица для хранения данных зарегистрированных пользователей. Поля priority\_score и is\_moder являются ключевыми для бизнес-логики: первый определяет приоритет при записи на партию (основа системы "давности игры"), второй — права доступа для модерации контента.
    
    \item characters: Хранит игровые персонажи, созданные пользователями. Связь user\_id позволяет одному пользователю иметь несколько персонажей, что соответствует игровой практике. Поле is\_active обеспечивает блокировку персонажа со стороны модерации, без строгого удаления.
    
    \item parties: Содержит информацию об игровых партиях (сессиях). Поля min\_players/max\_players и min\_player\_level/max\_player\_level задают ключевые правила формирования группы: количество и уровень участников. Статус (status), управляемый через ENUM, четко определяет жизненный цикл партии (от модерации до завершения). Связь dm\_id указывает на пользователя-ведущего (мастера).
    
    \item registrations: Реализует связь "многие-ко-многим" между персонажем и игровой сессией. Эта таблица-посредник критически необходима для обработки заявок: несколько персонажей могут регистрироваться на одну партию, и один персонаж может подавать заявки на разные партии. Поле status фиксирует решение ведущего или модератора по каждой заявке.
\end{enumerate}


Ключевые связи:
\begin{enumerate}[leftmargin=*, itemsep=0.5em]
    \item Один-ко-многим: Пользователи (users) могут создавать множество персонажей (characters). Пользователь как мастер может создать множество партий (parties). Каждая партия может получить множество заявок в registrations. Каждый персонаж (characters) может иметь множество заявок в registrations.
    
    \item Многие-ко-многим: Персонажи (characters) регистрируются на партии (parties) через таблицу-связку registrations.
\end{enumerate}


Гарантии целостности:
\begin{enumerate}[leftmargin=*, itemsep=0.5em]
    \item Первичные ключи (PRIMARY KEY): id во всех таблицах.
    \item Внешние ключи (FOREIGN KEY): Все связи между таблицами явно объявлены с правилами обработки удаления (CASCADE для зависимых записей, SET NULL для ведущего партии).
    \item Проверки (CHECK): Ограничения на уровни игроков и персонажей (BETWEEN 1 AND 20), логику количества игроков (max\_players >= min\_players).
    \item Уникальность (UNIQUE): username, email в users; name в characters (в рамках всей системы).
\end{enumerate}


Такая архитектура полностью покрывает требования к хранению данных для функционала регистрации, управления пользователями, персонажами и партиями с системой приоритетов, обеспечивая гибкость для расширения и эффективность выполнения запросов.


\section{Выводы}
% Краткий перечень результатов 


\conclusions % Заключение

В ходе практики были полностью/ частично выполнено Индивидуальное задание 

Планируемые результаты практики достигнуты полностью/ частично

% В ходе работы ... была проделана работа.

% \begin{thebibliography}{99} % Источники
% \bibitem{bib1} Источник 1
% \end{thebibliography}

% \Appendix % Приложения
% % Включаем сквозную нумерацию
% \counterwithin{figure}{chapter}
% \counterwithin{table}{chapter}
% \counterwithin{equation}{chapter}
% \chapter{Название приложения}

\end{document}


% \section{Рисунки и картинки}

% На все рисунки и таблицы должны быть ссылки (рисунок \ref{ezhik}).

% \begin{figure}[H]
%     \centering
%     \includegraphics[width=0.8\linewidth]{graphics/ezhik.jpg}
%     \caption{Название с большой буквы без точки в конце}
%     \label{ezhik}
% \end{figure}

% \section{Таблицы}

% Немного данных представлены в таблице \ref{table:power}.

% \begin{table}[H] 
% \caption{Перечень подсистем\label{table:power}} \centering \begin{tabular}{ |p{100mm}|p{60mm}| } \hline 
% \begin{center}\vspace*{-\baselineskip}\textbf{Показатель}\vspace*{-\baselineskip}\end{center} & \begin{center}\vspace*{-\baselineskip}\textbf{Целевое значение}\vspace*{-\baselineskip}\end{center} \\ \hline 
% Нормальный режим функционирования системы & 365 дней в году, 7 дней в неделю, 24 часа в сутки  \\ \hline
% Среднее время отклика системы на действия пользователей при просмотре информации в мобильном приложении & Не более 0,3 сек. \\ \hline
% Среднее время отклика системы на действия пользователей при использовании микрофона & Не более 1 сек. \\ \hline
% Среднее время работы системы при совершении перевода & Не более 3 сек. \\ \hline
% \end{tabular} \end{table}

% Много данных представлены в таблице \ref{table:structfunc}.

% \begin{longtable}{|>{\hspace{0pt}}p{40mm}|>{\hspace{0pt}}p{120mm}|}
% \caption{Перечень функций структурных подсистем\label{table:structfunc}} \\ \hline
% \centering\textbf{Структурная подсистема} & \centering\textbf{Функции подсистемы}  \tabularnewline \hline \endfirsthead
% \multicolumn{2}{l}{\hspace{-8pt}Продолжение таблицы \ref{table:structfunc}} \\ \hline{}
% \centering\textbf{Структурная подсистема}  & \centering\textbf{Функции подсистемы} \tabularnewline\hline \endhead

% Сервер баз данных &
% Функции хранилища: 
% \begin{itemize}[leftmargin=5mm]
%     \item хранение баз данных и медиафайлов;
%     \item автоматическое резервное копирование и восстановление баз данных и медиафайлов;
%     \item загрузка медиафайлов из сторонних ресурсов.
% \end{itemize}
% Функции СУБД: 
% \begin{itemize}[leftmargin=5mm]
%     \item асинхронный быстрый поиск в базах данных;
%     \item асинхронный доступ к медиафайлам;
%     \item потоковая передача медиафайлов;
%     \item доступ к изменению модераторами и администраторами содержания базы данных;
%     \item доступ к загрузке и удалению модераторами и администраторами медиафайлов.
% \end{itemize} \\ \hline

% Языковая модель переводчика & 
% Функции перевода: 
% \begin{itemize}[leftmargin=5mm]
%     \item разбиение фразы на члены предложения;
%     \item подбор синонимов, имеющих жестовый эквивалент;
%     \item составление грамматически упорядоченного набора жестов.
% \end{itemize} \\ \hline

% Сервис "Текстово-голосовой чат" & 
% Функции для 1 участника диалога: 
% \begin{itemize}[leftmargin=5mm]
%     \item набор письменного текста;
%     \item озвучивание текста;
%     \item сохранение важных фраз.
% \end{itemize} 
% Функции для 2 участника диалога: 
% \begin{itemize}[leftmargin=5mm]
%     \item запись голоса;
%     \item преобразование голоса в текст.
% \end{itemize} \\ \hline

% Сервис "Обучающие материалы" & Представление пошаговых обучающих материалов, тестов на время, тестов на правильность. Сохранение прогресса. \\ \hline
% \end{longtable}